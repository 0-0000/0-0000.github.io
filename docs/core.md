# miniExtend Core #
对应源文件： `core.lua` 。  
miniExtend 已尽可能恢复标准 lua 环境，这意味着你能正常调用那些被删除的基本函数。  
以下是有相对标准 lua 环境有所不同的部分：  
## `loadstring2(string, [, chuckname])` 函数 ##
- 增加了 `loadstring2(string [, chuckname])` 函数，该函数等价于 `LoadLuaScript(string, [, chuckname])` 函数，使用它代替 `LoadLuaScript()` 函数。  
- 该函数效果类似于 lua51 基本函数 `loadstring(string, [, chuckname]` 。
- 但是 `loadstring()` 运行时的 `_G` 完全是标准的 lua51 的 `_G` ，它**不能访问迷你世界 API ，当前脚本下的全局变量，包括 miniExtend**。  
- 而 `loadstring2()` 运行时的 `_G` 等于你的脚本中的 `_G` 。  
- 简而言之，当解析的代码只进行一些简单的计算，不需要 API 和交换数据的话，使用 `loadstring()` ，否则使用 `loadstring2()` 。  
## `_G2` 表 ##
- 只要一个脚本在 miniExtend 的 `core` 脚本后运行，都能直接访问该表，因此可以通过 `_G2` 来在各个脚本之间交换数据。  
- 不要使用 `"__" + 大写字母组合` 来作为自己的索引，因为 miniExtend 使用这种标识符作为索引存储一些变量，你可以遍历 `_G2` 来确定 miniExtend 使用了哪些标识符。  
- `loadstring()` 返回的函数执行时不能使用 `_G2` 。  
## 注意事项 ##
由于迷你世界不是简单的 lua 解释器，有时还会在服务器上运行，因此一些 lua 基本函数可能有歧义。  
对于任何访问系统的函数，例如 `io`, `package`, `os.execute` ，它们大多本是被删除的函数和库，其行为取决于游戏的服务器。 
 
- 在单人模式下，服务器就是玩家的设备。  
- 由房主开启的多人游戏，服务器是房主的设备。  
- 开发者申请的云服，服务器是迷你世界管理该云服的服务器（这可能不准确因为没有明确的证据证明这一点）。  

这些函数只会在服务器上运行，访问的操作系统方法也取决于服务器。  
而且，其中的某些函数可能很危险，以下是一些例子：  

- 如果你使用 `io.close();` ，这将关闭默认输出文件，在 lua 上因为不能关闭标准文件而失败，但在迷你世界中，这将导致<a title="这似乎会使游戏保存，再次打开地图仍是玩法模式，然后继续关闭……所以请使用编辑模式打开">程序突然关闭</a>。  
- 在 Windows 下执行 `os.execute("cmd")` ，会弹出一个 cmd 窗口，而且该窗口会阻塞程序运行，除非手动关闭，这也非常难看。  
